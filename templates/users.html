{% extends "layout.html" %}
{% block content %}

<div class="search-section" style="margin-bottom: 40px;">
    <h1 class="page-title"><i class="fas fa-users-cog"></i> إدارة المستخدمين الصلاحيات</h1>
    <p class="page-subtitle">أضف حسابات جديدة للمسؤولين وحذف من لا تثق به.</p>
</div>

<!-- نموذج إضافة مستخدم جديد -->
<div class="upload-container" style="max-width: 600px; margin: 0 auto 50px auto;">
    <div class="upload-header text-center" style="padding: 20px;">
        <h3><i class="fas fa-user-plus"></i> إضافة مسؤول جديد</h3>
    </div>
    <div class="upload-card">
        <form action="{{ url_for('manage_users') }}" method="POST" class="upload-form">
            <div class="form-group">
                <label for="username"><i class="fas fa-user"></i> اسم المستخدم</label>
                <input type="text" id="username" name="username" class="form-control" required placeholder="مثال: Ahmed_admin">
            </div>
            <div class="form-group">
                <label for="password"><i class="fas fa-key"></i> كلمة المرور</label>
                <input type="password" id="password" name="password" class="form-control" required placeholder="كلمة مرور قوية...">
            </div>
            <div class="form-actions mt-4">
                <button type="submit" class="btn-primary btn-block"><i class="fas fa-user-shield"></i> إنشاء الحساب وإعطاء الصلاحيات</button>
            </div>
        </form>
    </div>
</div>

<!-- جدول المسؤولين الحاليين -->
<h2 style="margin-bottom: 20px; border-bottom: 1px solid var(--glass-border); padding-bottom: 10px; text-align: center;">
    <i class="fas fa-users"></i> قائمة المسؤولين الحالية
</h2>

<div style="overflow-x: auto; max-width: 800px; margin: 0 auto;">
    <table style="width: 100%; border-collapse: collapse; background: var(--card-bg); border-radius: 12px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.2);">
        <thead style="background: rgba(0,210,255,0.1);">
            <tr>
                <th style="padding: 15px; text-align: right; border-bottom: 1px solid var(--glass-border);"><i class="fas fa-id-badge"></i> الرقم</th>
                <th style="padding: 15px; text-align: right; border-bottom: 1px solid var(--glass-border);"><i class="fas fa-user"></i> اسم المستخدم</th>
                <th style="padding: 15px; text-align: center; border-bottom: 1px solid var(--glass-border);"><i class="fas fa-cogs"></i> الإجراءات</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr style="border-bottom: 1px solid rgba(255,255,255,0.05); transition: background 0.3s;">
                <td style="padding: 15px;">#{{ user.id }}</td>
                <td style="padding: 15px; font-weight: bold; color: var(--primary-color);">
                    {{ user.username }}
                    {% if user.id == 1 %}
                    <span style="background: rgba(255,215,0,0.2); color: gold; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem; margin-right: 10px;"><i class="fas fa-crown"></i> الحساب الأساسي</span>
                    {% endif %}
                </td>
                <td style="padding: 15px; text-align: center;">
                    {% if user.id != 1 %}
                    <form action="{{ url_for('delete_user', user_id=user.id) }}" method="POST" style="display:inline;" onsubmit="return confirm('إزالة كافة صلاحيات هذا المستخدم وحذفه نهائياً؟');">
                        <button type="submit" class="btn-danger" style="background-color: var(--error-color); color: white; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;"><i class="fas fa-user-times"></i> حذف الحساب</button>
                    </form>
                    {% else %}
                    <span style="color: var(--text-muted); font-size: 0.9rem;">غير قابل للحذف</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
